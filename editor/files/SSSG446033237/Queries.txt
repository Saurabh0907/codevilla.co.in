1. List the names and date of all type of rawmaterials used in your company.

select r.name,r.date
from expenditure e, rawmaterial r
where e.type = r.type;

2. List the name of raw materials having cost between 2,00,000 and 3,00,000

select name
from rawmaterial
where cost > 200000 AND cost <300000;

3. List all type of unsecured loans taken by the company

select * from loansfrombank where category='unsecured';


4. List the name and date of assets where company id is 1234567890 and date >2012-10-11

select name
from assets,funds
where funds.regid = 1234567890
AND funds.billno = assets.billno AND assets.date > '2012-10-11';


5. list the name and price of shares bought between 11-10-2012 and 14-10-2012

select name,price
from shares
where date>'2012-10-11' AND date < '2012-10-14';


6 List the name of product company and director id with investment billno 9999

select p.name,p.did
from products p,funds f,investments i
where i.billno=9999 AND i.billno = f.billno AND f.id = p.id;


7 select the billno of funds owned by the product company directed by director with id 4

select d.name,p.name,f.billno
from Directors d,funds f,products p
where d.id = p.did AND p.id = f.id AND d.id = 4;

8.  list the name of share with maximum and minimum price where product id is 12348

select s1.name,max(s1.price)
from shareholding s,products p,shares s1
where s.pid = p.id AND s.pid = 12348 AND s.name = s1.name


9. List the type and date of expenditure of the product APRS mobi

select e.type
from expenditure e,Products p,brandrel b
where e.type=b.type AND b.id=p.id AND p.name='APRS mobi';

10. List the name of director who directs the company with share name 
petrofac 

select d.name
from Directors d,products p,shareholding s
where d.id = p.did AND p.id = s.pid AND s.name = 'Petrofac';

11. Find the name and number of shares of the product company who invested in 
either mutual or corporate type investments

select p.name,count(*)
from shareholding s,funds f,investments i,products p
where s.pid = p.id AND p.id = f.id AND f.billno = i.billno AND 
i.billno IN (select billno from investments where type = 'Mutual' OR 
type = 'Corporate')
group by p.id;


12. Show the expenditure  detail of the company 
 who invested money in IDBILIQUID

select e.type,e.month
from expenditure e,brandrel b
where e.type = b.type AND b.id IN (select p.id from products p,funds f,investments i
where i.name = 'IDBILIQUID' AND i.billno = f.billno AND f.id = p.id);


13. List the asset name and price of each product

select p.id,a.name,a.price
from assets a,products p,funds f
where p.id = f.id AND f.billno = a.billno
group by p.id;


14. List name of shares whose category limit lie between 500 and 1500

select shares.name
from shares,shareholding
where categorylimit >500 AND categorylimit < 1500 AND Shares.name = shareholding.name;

15. find name of product company with more than average raw material cost

select p.name,p.did
from products p,brandrel b,expenditure e,rawmaterial r
where p.id = b.id AND b.type = e.type AND e.type=r.type AND 
r.cost > (select avg(cost) from rawmaterial);













22. list the name and loans taken by product directed by Saurabh


select p.name,p.loans
from products p,Directors d
where p.did=d.id AND d.name = 'Saurabh';



















17. List the type of rawmaterial OR Manufacturing used
 by the company whose director is Pratham

select r.type from rawmaterial r,expenditure e,brandrel b
where r.type = e.type AND e.type = b.type AND
b.id IN (select p.id from products p,Directors d where p.did = d.id
AND d.name = 'Pratham')

UNION

select m.type from manufacturing m,expenditure e,brandrel b
where m.type = e.type AND e.type = b.type AND
b.id IN (select p.id from products p,Directors d where p.did = d.id
AND d.name = 'Pratham');

10. List the name of director who directs the company with share name 
petrofac 

select d.name
from Directors d,products p,shareholding s
where d.id = p.did AND p.id = s.pid AND s.name = 'Petrofac';

11. List the name of assets bought on 2012-10-12
with company id 1234567890

select name from assets,funds
where date = '2012-10-12' AND assets.billno=funds.billno AND regid=1234567890;

12. Calculate the sum of cost of all type of mutual investments done 

select sum(cost) from investments where type= 'Mutual';

13. Calculate the no. of product companies directed by each director

select d.name,count(*) 
from Directors d,products p
where d.id = p.did
group by d.id; 

8.  list the name of share with maximum and minimum price where product id is 12348

select s1.name,max(s1.price)
from shareholding s,products p,shares s1
where s.pid = p.id AND s.pid = 12348 AND s.name = s1.name







